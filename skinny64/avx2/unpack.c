#include "Skinny64128AVX2.h"

void pack_message(u256 x[16], const unsigned char *in) {
  int i;
  u256 data[16];

  for(i = 0; i < 16; i++) {
    data[i] = LOAD(in + i*32);
  }

  //Load individual bits of each S-box
  x[0] = XOR(XOR(XOR(AND(data[0], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[1], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[2], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[3], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[1] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[1], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[2], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[3], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[2] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[1], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[2], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[3], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[3] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[1], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[2], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[3], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[4] = XOR(XOR(XOR(AND(data[4], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[5], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[6], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[7], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[5] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[5], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[6], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[7], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[6] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[5], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[6], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[7], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[7] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[5], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[6], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[7], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[8] = XOR(XOR(XOR(AND(data[8], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[9], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[10], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[11], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[9] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[9], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[10], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[11], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[10] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[9], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[10], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[11], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[11] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[9], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[10], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[11], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[12] = XOR(XOR(XOR(AND(data[12], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[13], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[14], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[15], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[13] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[13], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[14], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[15], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[14] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[13], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[14], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[15], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[15] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[13], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[14], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[15], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
 
  //Group the rows for efficient MixRows implementation
  data[0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));  

  //Rearrange nibbles for efficient ShiftRows
  x[0] = XOR(XOR(AND(data[0], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[0], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[0], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[1] = XOR(XOR(AND(data[1], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[1], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[1], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[2] = XOR(XOR(AND(data[2], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[2], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[2], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[3] = XOR(XOR(AND(data[3], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[3], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[3], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[4] = XOR(XOR(AND(data[4], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[4], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[4], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[5] = XOR(XOR(AND(data[5], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[5], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[5], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[6] = XOR(XOR(AND(data[6], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[6], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[6], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[7] = XOR(XOR(AND(data[7], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[7], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[7], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[8] = XOR(XOR(AND(data[8], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[8], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[8], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[9] = XOR(XOR(AND(data[9], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[9], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[9], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[10] = XOR(XOR(AND(data[10], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[10], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[10], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[11] = XOR(XOR(AND(data[11], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[11], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[11], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[12] = XOR(XOR(AND(data[12], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[12], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[12], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[13] = XOR(XOR(AND(data[13], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[13], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[13], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[14] = XOR(XOR(AND(data[14], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[14], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[14], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[15] = XOR(XOR(AND(data[15], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[15], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[15], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));

}

void pack_key(u256 x[16], const unsigned char *in) {
  int i;
  u256 data[16];

  for(i = 0; i < 16; i++) {
    data[i] = LOAD(in); //Load same key for all blocks
  }

  u256 test = _mm256_shuffle_epi8(data[0 + 0], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,1,0));

  x[0] = XOR(XOR(XOR(AND(data[0], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[1], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[2], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[3], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[1] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[1], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[2], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[3], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[2] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[1], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[2], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[3], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[3] = XOR(XOR(XOR(SHIFTL64(AND(data[0], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[1], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[2], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[3], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[4] = XOR(XOR(XOR(AND(data[4], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[5], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[6], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[7], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[5] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[5], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[6], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[7], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[6] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[5], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[6], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[7], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[7] = XOR(XOR(XOR(SHIFTL64(AND(data[4], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[5], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[6], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[7], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[8] = XOR(XOR(XOR(AND(data[8], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[9], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[10], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[11], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[9] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[9], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[10], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[11], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[10] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[9], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[10], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[11], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[11] = XOR(XOR(XOR(SHIFTL64(AND(data[8], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[9], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[10], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[11], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  x[12] = XOR(XOR(XOR(AND(data[12], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(data[13], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(data[14], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(data[15], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  x[13] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(data[13], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(data[14], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(data[15], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  x[14] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(data[13], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(data[14], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(data[15], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  x[15] = XOR(XOR(XOR(SHIFTL64(AND(data[12], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(data[13], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(data[14], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(data[15], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
 
  data[0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[4 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[8 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 0], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 0], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 1], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 1], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 2], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 2], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  data[12 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(x[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(x[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(x[8 + 3], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(x[12 + 3], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));  

  x[0] = XOR(XOR(AND(data[0], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[0], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[0], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[1] = XOR(XOR(AND(data[1], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[1], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[1], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[2] = XOR(XOR(AND(data[2], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[2], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[2], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[3] = XOR(XOR(AND(data[3], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[3], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[3], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[4] = XOR(XOR(AND(data[4], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[4], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[4], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[5] = XOR(XOR(AND(data[5], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[5], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[5], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[6] = XOR(XOR(AND(data[6], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[6], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[6], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[7] = XOR(XOR(AND(data[7], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[7], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[7], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[8] = XOR(XOR(AND(data[8], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[8], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[8], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[9] = XOR(XOR(AND(data[9], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[9], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[9], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[10] = XOR(XOR(AND(data[10], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[10], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[10], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[11] = XOR(XOR(AND(data[11], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[11], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[11], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[12] = XOR(XOR(AND(data[12], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[12], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[12], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[13] = XOR(XOR(AND(data[13], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[13], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[13], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[14] = XOR(XOR(AND(data[14], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[14], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[14], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  x[15] = XOR(XOR(AND(data[15], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(data[15], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(data[15], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
}

//Unpacking
void unpack_and_store_message(unsigned char *out, u256 x[16]) {
  u256 data[16];
  int i;

  data[0] = XOR(XOR(AND(x[0], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[0], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[0], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[1] = XOR(XOR(AND(x[1], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[1], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[1], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[2] = XOR(XOR(AND(x[2], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[2], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[2], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[3] = XOR(XOR(AND(x[3], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[3], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[3], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[4] = XOR(XOR(AND(x[4], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[4], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[4], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[5] = XOR(XOR(AND(x[5], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[5], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[5], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[6] = XOR(XOR(AND(x[6], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[6], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[6], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[7] = XOR(XOR(AND(x[7], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[7], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[7], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[8] = XOR(XOR(AND(x[8], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[8], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[8], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[9] = XOR(XOR(AND(x[9], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[9], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[9], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[10] = XOR(XOR(AND(x[10], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[10], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[10], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[11] = XOR(XOR(AND(x[11], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[11], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[11], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[12] = XOR(XOR(AND(x[12], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[12], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[12], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[13] = XOR(XOR(AND(x[13], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[13], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[13], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[14] = XOR(XOR(AND(x[14], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[14], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[14], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));
  data[15] = XOR(XOR(AND(x[15], _mm256_set_epi32(0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f,0xf0f00f0f)), SHIFTL64(AND(x[15], _mm256_set_epi32(0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0,0x0000f0f0)), 12)), SHIFTR64(AND(x[15], _mm256_set_epi32(0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000,0x0f0f0000)), 12));


  x[0] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(data[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 0], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 0], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[1] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(data[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 1], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 1], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[2] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(data[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 2], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 2], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[3] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0)), _mm256_shuffle_epi8(data[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 3], _mm256_set_epi8(0xff,0xff,25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 3], _mm256_set_epi8(25,24,0xff,0xff,0xff,0xff,0xff,0xff,17,16,0xff,0xff,0xff,0xff,0xff,0xff, 9, 8,0xff,0xff,0xff,0xff,0xff,0xff, 1, 0,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[4 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(data[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 0], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 0], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[4 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(data[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 1], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 1], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[4 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(data[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 2], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 2], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[4 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2)), _mm256_shuffle_epi8(data[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 3], _mm256_set_epi8(0xff,0xff,27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 3], _mm256_set_epi8(27,26,0xff,0xff,0xff,0xff,0xff,0xff,19,18,0xff,0xff,0xff,0xff,0xff,0xff,11,10,0xff,0xff,0xff,0xff,0xff,0xff, 3, 2,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[8 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(data[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 0], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 0], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[8 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(data[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 1], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 1], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[8 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(data[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 2], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 2], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[8 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4)), _mm256_shuffle_epi8(data[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 3], _mm256_set_epi8(0xff,0xff,29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 3], _mm256_set_epi8(29,28,0xff,0xff,0xff,0xff,0xff,0xff,21,20,0xff,0xff,0xff,0xff,0xff,0xff,13,12,0xff,0xff,0xff,0xff,0xff,0xff, 5, 4,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[12 + 0] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(data[4 + 0], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 0], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 0], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[12 + 1] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(data[4 + 1], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 1], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 1], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[12 + 2] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(data[4 + 2], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 2], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 2], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));
  x[12 + 3] = XOR(XOR(XOR(_mm256_shuffle_epi8(data[0 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6)), _mm256_shuffle_epi8(data[4 + 3], _mm256_set_epi8(0xff,0xff,0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff))), _mm256_shuffle_epi8(data[8 + 3], _mm256_set_epi8(0xff,0xff,31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff))), _mm256_shuffle_epi8(data[12 + 3], _mm256_set_epi8(31,30,0xff,0xff,0xff,0xff,0xff,0xff,23,22,0xff,0xff,0xff,0xff,0xff,0xff,15,14,0xff,0xff,0xff,0xff,0xff,0xff, 7, 6,0xff,0xff,0xff,0xff,0xff,0xff)));

  data[0] = XOR(XOR(XOR(AND(x[0], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(x[1], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(x[2], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(x[3], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  data[1] = XOR(XOR(XOR(SHIFTL64(AND(x[0], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(x[1], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(x[2], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(x[3], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  data[2] = XOR(XOR(XOR(SHIFTL64(AND(x[0], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(x[1], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(x[2], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(x[3], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  data[3] = XOR(XOR(XOR(SHIFTL64(AND(x[0], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(x[1], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(x[2], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(x[3], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  data[4] = XOR(XOR(XOR(AND(x[4], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(x[5], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(x[6], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(x[7], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  data[5] = XOR(XOR(XOR(SHIFTL64(AND(x[4], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(x[5], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(x[6], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(x[7], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  data[6] = XOR(XOR(XOR(SHIFTL64(AND(x[4], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(x[5], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(x[6], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(x[7], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  data[7] = XOR(XOR(XOR(SHIFTL64(AND(x[4], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(x[5], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(x[6], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(x[7], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  data[8] = XOR(XOR(XOR(AND(x[8], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(x[9], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(x[10], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(x[11], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  data[9] = XOR(XOR(XOR(SHIFTL64(AND(x[8], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(x[9], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(x[10], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(x[11], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  data[10] = XOR(XOR(XOR(SHIFTL64(AND(x[8], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(x[9], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(x[10], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(x[11], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  data[11] = XOR(XOR(XOR(SHIFTL64(AND(x[8], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(x[9], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(x[10], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(x[11], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));
  data[12] = XOR(XOR(XOR(AND(x[12], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), SHIFTR64(AND(x[13], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 1)),SHIFTR64(AND(x[14], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 2)),SHIFTR64(AND(x[15], _mm256_set_epi32(0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888)), 3));
  data[13] = XOR(XOR(XOR(SHIFTL64(AND(x[12], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1),AND(x[13], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444))),SHIFTR64(AND(x[14], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 1)),SHIFTR64(AND(x[15], _mm256_set_epi32(0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444, 0x44444444)), 2));
  data[14] = XOR(XOR(XOR(SHIFTL64(AND(x[12], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 2),SHIFTL64(AND(x[13], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1)),AND(x[14], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222))),SHIFTR64(AND(x[15], _mm256_set_epi32(0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222, 0x22222222)), 1));
  data[15] = XOR(XOR(XOR(SHIFTL64(AND(x[12], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 3),SHIFTL64(AND(x[13], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 2)),SHIFTL64(AND(x[14], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)), 1)),AND(x[15], _mm256_set_epi32(0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111, 0x11111111)));

  STORE(out + 32*0,  data[0]);
  STORE(out + 32*1,  data[1]);
  STORE(out + 32*2,  data[2]);
  STORE(out + 32*3,  data[3]);
  STORE(out + 32*4,  data[4]);
  STORE(out + 32*5,  data[5]);
  STORE(out + 32*6,  data[6]);
  STORE(out + 32*7,  data[7]);
  STORE(out + 32*8,  data[8]);
  STORE(out + 32*9,  data[9]);
  STORE(out + 32*10, data[10]);
  STORE(out + 32*11, data[11]);
  STORE(out + 32*12, data[12]);
  STORE(out + 32*13, data[13]);
  STORE(out + 32*14, data[14]);
  STORE(out + 32*15, data[15]);
}
